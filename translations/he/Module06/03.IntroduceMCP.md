<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "8a7765b85f123e8a62aa3847141ca072",
  "translation_date": "2025-10-30T13:30:35+00:00",
  "source_file": "Module06/03.IntroduceMCP.md",
  "language_code": "he"
}
-->
# סעיף 03 - שילוב פרוטוקול הקשר מודל (MCP)

## הקדמה ל-MCP (פרוטוקול הקשר מודל)

פרוטוקול הקשר מודל (MCP) הוא תקן קוד פתוח שמאפשר חיבור יישומי AI למערכות חיצוניות. באמצעות MCP, יישומי AI כמו Claude או ChatGPT יכולים להתחבר למקורות מידע (לדוגמה, קבצים מקומיים, מסדי נתונים), כלים (לדוגמה, מנועי חיפוש, מחשבונים) ותהליכי עבודה (לדוגמה, הנחיות מיוחדות)—ובכך לגשת למידע חשוב ולבצע משימות.

חשבו על MCP כמו **חיבור USB-C ליישומי AI**. בדיוק כמו ש-USB-C מספק דרך סטנדרטית לחיבור מכשירים אלקטרוניים, MCP מספק דרך סטנדרטית לחיבור יישומי AI למערכות חיצוניות.

### מה MCP מאפשר?

MCP פותח יכולות עוצמתיות ליישומי AI:

- **עוזרים אישיים מותאמים אישית**: סוכנים יכולים לגשת ליומן Google ול-Notion שלך, ולפעול כעוזר AI מותאם אישית יותר  
- **יצירת קוד מתקדמת**: Claude Code יכול ליצור אפליקציית אינטרנט שלמה באמצעות עיצוב Figma  
- **שילוב נתונים ארגוניים**: צ'אטבוטים ארגוניים יכולים להתחבר למספר מסדי נתונים בארגון, ולאפשר למשתמשים לנתח נתונים באמצעות צ'אט  
- **תהליכי עבודה יצירתיים**: מודלים של AI יכולים ליצור עיצובים תלת-ממדיים ב-Blender ולהדפיס אותם במדפסת תלת-ממד  
- **גישה למידע בזמן אמת**: חיבור למקורות נתונים חיצוניים למידע עדכני  
- **פעולות מורכבות רב-שלביות**: ביצוע תהליכי עבודה מתוחכמים שמשלבים כלים ומערכות מרובות  

### למה MCP חשוב?

MCP מספק יתרונות בכל רחבי האקוסיסטם:

**למפתחים**: MCP מפחית את זמן הפיתוח ואת המורכבות בבניית או שילוב יישום או סוכן AI.

**ליישומי AI**: MCP מספק גישה לאקוסיסטם של מקורות נתונים, כלים ואפליקציות שמשפרים את היכולות ומשפרים את חוויית המשתמש.

**למשתמשי קצה**: MCP מוביל ליישומי AI או סוכנים מתקדמים יותר שיכולים לגשת לנתונים שלך ולבצע פעולות עבורך בעת הצורך.

## מודלים לשוניים קטנים (SLMs) ב-MCP

מודלים לשוניים קטנים מציעים גישה יעילה לפריסת AI, עם מספר יתרונות:

### יתרונות של SLMs
- **יעילות משאבים**: דרישות חישוביות נמוכות  
- **זמני תגובה מהירים**: הפחתת השהייה ליישומים בזמן אמת  
- **חסכוניות**: צרכים מינימליים בתשתית  
- **פרטיות**: יכולים לפעול מקומית ללא העברת נתונים  
- **התאמה אישית**: קל יותר לכוונן עבור תחומים ספציפיים  

### למה SLMs עובדים טוב עם MCP

SLMs בשילוב עם MCP יוצרים שילוב עוצמתי שבו יכולות ההסקה של המודל מוגברות על ידי כלים חיצוניים, ומפצות על מספר הפרמטרים הקטן יותר באמצעות פונקציונליות משופרת.

## סקירה של Python MCP SDK

Python MCP SDK מספק את הבסיס לבניית יישומים עם יכולות MCP. ה-SDK כולל:

- **ספריות לקוח**: לחיבור לשרתי MCP  
- **מסגרת שרת**: ליצירת שרתי MCP מותאמים אישית  
- **מטפלי פרוטוקול**: לניהול תקשורת  
- **שילוב כלים**: לביצוע פונקציות חיצוניות  

## יישום מעשי: לקוח Phi-4 MCP

בואו נחקור יישום בעולם האמיתי באמצעות המודל המינימלי Phi-4 של Microsoft עם יכולות MCP.

### סקירה של ארכיטקטורת MCP

MCP פועל לפי **ארכיטקטורת לקוח-שרת** שבה מארח MCP (יישום AI כמו Claude Code או Claude Desktop) יוצר חיבורים לאחד או יותר שרתי MCP. מארח MCP משיג זאת על ידי יצירת לקוח MCP עבור כל שרת MCP.

#### משתתפים מרכזיים

- **מארח MCP**: יישום AI שמנהל ומתאם לקוחות MCP מרובים  
- **לקוח MCP**: רכיב שמתחזק חיבור לשרת MCP ומקבל הקשר משרת MCP לשימוש המארח  
- **שרת MCP**: תוכנה שמספקת הקשר ללקוחות MCP  

#### ארכיטקטורה דו-שכבתית

MCP מורכב משתי שכבות נפרדות:

**שכבת נתונים**: מגדירה את הפרוטוקול מבוסס JSON-RPC לתקשורת לקוח-שרת, כולל:
- ניהול מחזור חיים (אתחול חיבור, משא ומתן על יכולות)  
- פרימיטיבים מרכזיים (כלים, משאבים, הנחיות)  
- תכונות לקוח (דגימה, איסוף מידע, רישום)  
- תכונות עזר (התראות, מעקב אחר התקדמות)  

**שכבת תעבורה**: מגדירה את מנגנוני התקשורת והערוצים:
- **תעבורת STDIO**: משתמשת בזרמי קלט/פלט סטנדרטיים לתהליכים מקומיים (ביצועים מיטביים, ללא תקורה רשתית)  
- **תעבורת HTTP ניתנת להזרמה**: משתמשת ב-HTTP POST עם אירועים שנשלחים מהשרת לשרתים מרוחקים (תומך באימות HTTP סטנדרטי)  

```
┌─────────────────────────────────────┐
│           MCP Host                  │
│     (AI Application)                │
└─────────────────┬───────────────────┘
                  │
┌─────────────────┴───────────────────┐
│         MCP Client 1                │
│  ┌─────────────────────────────────┐ │
│  │        Data Layer               │ │
│  │  ├── Lifecycle Management       │ │
│  │  ├── Primitives (Tools/Resources)│ │
│  │  └── Notifications              │ │
│  └─────────────────────────────────┘ │
│  ┌─────────────────────────────────┐ │
│  │      Transport Layer           │ │
│  │  ├── STDIO Transport           │ │
│  │  └── HTTP Transport            │ │
│  └─────────────────────────────────┘ │
└─────────────────┬───────────────────┘
                  │
┌─────────────────┴───────────────────┐
│         MCP Server 1                │
│    (Local/Remote Context Provider)  │
└─────────────────────────────────────┘
```

### פרימיטיבים מרכזיים של MCP

MCP מגדיר פרימיטיבים שמפרטים את סוגי המידע ההקשרי שניתן לשתף עם יישומי AI ואת מגוון הפעולות שניתן לבצע.

#### פרימיטיבים של שרת

MCP מגדיר שלושה פרימיטיבים מרכזיים ששרתים יכולים לחשוף:

**כלים**: פונקציות ניתנות לביצוע שיישומי AI יכולים להפעיל כדי לבצע פעולות  
- דוגמאות: פעולות קבצים, קריאות API, שאילתות מסד נתונים  
- שיטות: `tools/list`, `tools/call`  
- תומך בגילוי וביצוע דינמיים  

**משאבים**: מקורות נתונים שמספקים מידע הקשרי ליישומי AI  
- דוגמאות: תוכן קבצים, רשומות מסד נתונים, תגובות API  
- שיטות: `resources/list`, `resources/read`  
- מאפשרים גישה לנתונים מובנים  

**הנחיות**: תבניות לשימוש חוזר שמסייעות במבנה אינטראקציות עם מודלים לשוניים  
- דוגמאות: הנחיות מערכת, דוגמאות few-shot  
- שיטות: `prompts/list`, `prompts/get`  
- סטנדרטיזציה של דפוסי אינטראקציה עם AI  

#### פרימיטיבים של לקוח

MCP גם מגדיר פרימיטיבים שלקוחות יכולים לחשוף כדי לאפשר אינטראקציות עשירות יותר:

**דגימה**: מאפשר לשרתים לבקש השלמות מודל לשוני מיישום ה-AI של הלקוח  
- שיטה: `sampling/complete`  
- מאפשר פיתוח שרתים בלתי תלוי במודל  
- מספק גישה למודל הלשוני של המארח  

**איסוף מידע**: מאפשר לשרתים לבקש מידע נוסף ממשתמשים  
- שיטה: `elicitation/request`  
- מאפשר אינטראקציה ואישור משתמש  
- תומך באיסוף מידע דינמי  

**רישום**: מאפשר לשרתים לשלוח הודעות רישום ללקוחות  
- משמש לצורכי ניפוי שגיאות ומעקב  
- מספק נראות לפעולות שרת  

### מחזור חיים של פרוטוקול MCP

#### אתחול ומשא ומתן על יכולות

MCP הוא פרוטוקול מבוסס מצב שדורש ניהול מחזור חיים. תהליך האתחול משרת מספר מטרות קריטיות:

1. **משא ומתן על גרסת פרוטוקול**: מבטיח שלקוח ושרת משתמשים בגרסאות פרוטוקול תואמות (לדוגמה, "2025-06-18")  
2. **גילוי יכולות**: כל צד מצהיר על תכונות ופרימיטיבים נתמכים  
3. **החלפת זהות**: מספק מידע זיהוי וגרסה  

```python
# Example initialization request
{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "initialize",
  "params": {
    "protocolVersion": "2025-06-18",
    "capabilities": {
      "elicitation": {},  # Client supports user interaction
      "sampling": {}      # Client can provide LLM completions
    },
    "clientInfo": {
      "name": "edge-ai-client",
      "version": "1.0.0"
    }
  }
}
```

#### גילוי וביצוע כלים

לאחר האתחול, לקוחות יכולים לגלות ולבצע כלים:

```python
# Discover available tools
tools_response = await session.list_tools()

# Execute a tool
result = await session.call_tool(
    "weather_current",
    {
        "location": "San Francisco",
        "units": "imperial"
    }
)
```

#### התראות בזמן אמת

MCP תומך בהתראות בזמן אמת לעדכונים דינמיים:

```python
# Server sends notification when tools change
{
  "jsonrpc": "2.0",
  "method": "notifications/tools/list_changed"
}

# Client responds by refreshing tool list
await session.list_tools()  # Get updated tools
```

## התחלה: מדריך שלב-אחר-שלב

### שלב 1: הגדרת סביבה

התקן תלותים נדרשים:
```bash
pip install fastmcp mcp-python-client openai requests pyautogui Pillow
```

### שלב 2: תצורה בסיסית

הגדר משתני סביבה:
```python
# System Configuration
SYSTEM_PROMPT = "You are an AI assistant with some tools."

# Ollama Configuration (Local)
OLLAMA_URL = "http://localhost:11434/api/chat"
OLLAMA_MODEL_ID = "phi4-mini:3.8b-fp16"

# vLLM Configuration (Server)
VLLM_URL = "http://localhost:8000/v1"
VLLM_MODEL_ID = "microsoft/Phi-4-mini-instruct"
```

### שלב 3: הפעלת לקוח MCP ראשון

**הגדרת Ollama בסיסית:**
```bash
python ghmodel_mcp_demo.py
```

**שימוש ב-vLLM Backend:**
```bash
python ghmodel_mcp_demo.py --env vllm
```

**חיבור אירועים שנשלחים מהשרת:**
```bash
python ghmodel_mcp_demo.py --run sse
```

**שרת MCP מותאם אישית:**
```bash
python ghmodel_mcp_demo.py --server /path/to/server.py
```

### שלב 4: שימוש תכנותי

```python
import asyncio
from ghmodel_mcp_demo import OllamaClient, Phi4MiniMCPClient

async def automated_interaction():
    # Configure MCP server parameters
    server_params = StdioServerParameters(
        command="npx",
        args=["@playwright/mcp@latest"],
        env=None,
    )
    
    # Create MCP client and process tools
    async with Phi4MiniMCPClient(server_params) as mcp_client:
        tools = await process_mcp_tools(mcp_client)
        llm_client = OllamaClient()
        
        # Generate response with tool capabilities
        response, messages = await llm_client.generate_response(
            "Help me automate a web task",
            tools
        )
        return response

# Execute the automation
result = asyncio.run(automated_interaction())
print(result)
```

## תכונות מתקדמות

### תמיכה בריבוי Backend

היישום תומך גם ב-Ollama וגם ב-vLLM Backend, ומאפשר לך לבחור בהתאם לדרישותיך:

- **Ollama**: טוב יותר לפיתוח ובדיקה מקומיים  
- **vLLM**: מותאם לפרודקשן ותסריטים עם תפוקה גבוהה  

### פרוטוקולי חיבור גמישים

שני מצבי חיבור נתמכים:

**מצב STDIO**: תקשורת תהליך ישירה  
- השהייה נמוכה יותר  
- מתאים לכלים מקומיים  
- הגדרה פשוטה  

**מצב SSE**: הזרמה מבוססת HTTP  
- מתאים לרשת  
- טוב יותר למערכות מבוזרות  
- עדכונים בזמן אמת  

### יכולות שילוב כלים

המערכת יכולה להשתלב עם מגוון כלים:
- אוטומציה אינטרנטית (Playwright)  
- פעולות קבצים  
- אינטראקציות API  
- פקודות מערכת  
- פונקציות מותאמות אישית  

## טיפול בשגיאות ונהלים מומלצים

### ניהול שגיאות מקיף

היישום כולל טיפול שגיאות חזק עבור:

**שגיאות חיבור:**
- כשלי שרת MCP  
- פסקי זמן ברשת  
- בעיות קישוריות  

**שגיאות ביצוע כלים:**
- כלים חסרים  
- אימות פרמטרים  
- כשלי ביצוע  

**שגיאות עיבוד תגובות:**
- בעיות ניתוח JSON  
- אי עקביות בפורמט  
- אנומליות בתגובות LLM  

### נהלים מומלצים

1. **ניהול משאבים**: השתמש במנהלי הקשר אסינכרוניים  
2. **טיפול בשגיאות**: יישם בלוקים מקיפים של try-catch  
3. **רישום**: הפעל רמות רישום מתאימות  
4. **אבטחה**: אמת קלטים ונקה פלטים  
5. **ביצועים**: השתמש בבריכות חיבור ובמטמון  

## יישומים בעולם האמיתי

### אוטומציה אינטרנטית
```python
# Example: Automated web testing
async def web_automation_example():
    tools = await setup_playwright_tools()
    response = await llm_client.generate_response(
        "Navigate to example.com and take a screenshot",
        tools
    )
```

### עיבוד נתונים
```python
# Example: File analysis
async def data_processing_example():
    tools = await setup_file_tools()
    response = await llm_client.generate_response(
        "Analyze the CSV file and generate a summary report",
        tools
    )
```

### אינטגרציה עם API
```python
# Example: API interactions
async def api_integration_example():
    tools = await setup_api_tools()
    response = await llm_client.generate_response(
        "Fetch weather data and create a forecast summary",
        tools
    )
```

## אופטימיזציית ביצועים

### ניהול זיכרון
- טיפול יעיל בהיסטוריית הודעות  
- ניקוי משאבים נכון  
- בריכות חיבור  

### אופטימיזציית רשת
- פעולות HTTP אסינכרוניות  
- פסקי זמן ניתנים להגדרה  
- התאוששות שגיאות בצורה חלקה  

### עיבוד מקבילי
- I/O לא חוסם  
- ביצוע כלים במקביל  
- דפוסים אסינכרוניים יעילים  

## שיקולי אבטחה

### הגנת נתונים
- ניהול מאובטח של מפתחות API  
- אימות קלט  
- ניקוי פלט  

### אבטחת רשת
- תמיכה ב-HTTPS  
- ברירות מחדל לנקודות קצה מקומיות  
- טיפול מאובטח באסימונים  

### בטיחות ביצוע
- סינון כלים  
- סביבות מוגנות  
- רישום ביקורת  

## אקוסיסטם MCP ופיתוח

### היקף פרויקט MCP

אקוסיסטם פרוטוקול הקשר מודל כולל מספר רכיבים מרכזיים:

- **[מפרט MCP](https://modelcontextprotocol.io/specification/latest)**: מפרט רשמי שמפרט דרישות יישום ללקוחות ושרתים  
- **[SDKs של MCP](https://modelcontextprotocol.io/docs/sdk)**: SDKs לשפות תכנות שונות שמיישמות MCP  
- **כלי פיתוח MCP**: כלים לפיתוח שרתי ולקוחות MCP, כולל [MCP Inspector](https://github.com/modelcontextprotocol/inspector)  
- **[יישומי שרת MCP לדוגמה](https://github.com/modelcontextprotocol/servers)**: יישומים לדוגמה של שרתי MCP  

### התחלת פיתוח עם MCP

כדי להתחיל לבנות עם MCP:

**בניית שרתים**: [צור שרתי MCP](https://modelcontextprotocol.io/docs/develop/build-server) כדי לחשוף את הנתונים והכלים שלך  

**בניית לקוחות**: [פתח יישומים](https://modelcontextprotocol.io/docs/develop/build-client) שמתחברים לשרתי MCP  

**לימוד מושגים**: [הבנת מושגים מרכזיים](https://modelcontextprotocol.io/docs/learn/architecture) וארכיטקטורת MCP  

## סיכום

SLMs המשולבים עם MCP מייצגים שינוי פרדיגמה בפיתוח יישומי AI. על ידי שילוב היעילות של מודלים קטנים עם הכוח של כלים חיצוניים, מפתחים יכולים ליצור מערכות חכמות שהן גם יעילות במשאבים וגם בעלות יכולות גבוהות.

פרוטוקול הקשר מודל מספק דרך סטנדרטית לחיבור יישומי AI למערכות חיצוניות, בדומה ל-USB-C שמספק תקן חיבור אוניברסלי למכשירים אלקטרוניים. תקנון זה מאפשר:

- **שילוב חלק**: חיבור מודלי AI למקורות נתונים וכלים מגוונים  
- **צמיחת אקוסיסטם**: בנייה פעם אחת, שימוש במספר יישומי AI  
- **יכולות משופרות**: שיפור SLMs עם פונקציונליות חיצונית  
- **עדכונים בזמן אמת**: תמיכה ביישומי AI דינמיים ומגיבים  

נקודות מפתח:
- MCP הוא תקן פתוח שמגשר בין יישומי AI למערכות חיצוניות  
- הפרוטוקול תומך בכלים, משאבים והנחיות כפרימיטיבים מרכזיים  
- התראות בזמן אמת מאפשרות יישומים דינמיים ומגיבים  
- ניהול מחזור חיים נכון וטיפול בשגיאות חיוניים לשימוש בפרודקשן  
- האקוסיסטם מספק SDKs וכלי פיתוח מקיפים  

## מקורות וקריאה נוספת

### תיעוד רשמי של MCP

- **[אתר רשמי של פרוטוקול הקשר מודל](https://modelcontextprotocol.io/)** - תיעוד ומפרטים מלאים  
- **[מדריך התחלה של MCP](https://modelcontextprotocol.io/docs/getting-started/intro)** - מבוא ומושגים מרכזיים  
- **[סקירה של ארכיטקטורת MCP](https://modelcontextprotocol.io/docs/learn/architecture)** - ארכיטקטורה טכנית מפורטת  
- **[מפרט MCP](https://modelcontextprotocol.io/specification/latest)** - מפרט פרוטוקול רשמי  
- **[תיעוד SDKs של MCP](https://modelcontextprotocol.io/docs/sdk)** - מדריכים לשפות SDK  

### משאבי פיתוח

- **[MCP למתחילים](https://aka.ms/mcp-for-beginners)** - מדריך מקיף למתחילים לפרוטוקול הקשר מודל  
- **[ארגון GitHub של MCP](https://github.com/modelcontextprotocol)** - מאגרים ודוגמאות רשמיים  
- **[מאגר שרת MCP](https://github.com/modelcontextprotocol/servers)** - יישומי שרת לדוגמה  
- **[MCP Inspector](https://github.com/modelcontextprotocol/inspector)** - כלי פיתוח וניפוי שגיאות  
- **[מדריך בניית שרתי MCP](https://modelcontextprotocol.io/docs/develop/build-server)** - מדריך פיתוח שרתים  
- **[מדריך בניית לקוחות MCP](https://modelcontextprotocol.io/docs/develop/build-client)** - מדריך פיתוח לקוחות  

### מודלים לשוניים קטנים ו-AI בקצה

- **[מודלי Phi של Microsoft](https://aka.ms
- **[תיעוד Ollama](https://ollama.ai/docs)** - פלטפורמת פריסה מקומית של LLM  
- **[תיעוד vLLM](https://docs.vllm.ai/)** - שירות LLM בעל ביצועים גבוהים  

### תקנים טכניים ופרוטוקולים  

- **[JSON-RPC 2.0 Specification](https://www.jsonrpc.org/)** - פרוטוקול RPC בסיסי המשמש את MCP  
- **[JSON Schema](https://json-schema.org/)** - תקן להגדרת סכמות עבור כלי MCP  
- **[OpenAPI Specification](https://swagger.io/specification/)** - תקן לתיעוד API  
- **[Server-Sent Events (SSE)](https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events)** - תקן אינטרנט לעדכונים בזמן אמת  

### פיתוח סוכנים מבוססי AI  

- **[Microsoft Agent Framework](https://github.com/microsoft/agent-framework)** - פיתוח סוכנים מוכן לייצור  
- **[תיעוד LangChain](https://docs.langchain.com/)** - מסגרת לשילוב סוכנים וכלים  
- **[Semantic Kernel](https://learn.microsoft.com/en-us/semantic-kernel/)** - SDK לתזמור AI של מיקרוסופט  

### דוחות תעשייה ומחקר  

- **[הכרזת פרוטוקול הקשר מודל של Anthropic](https://www.anthropic.com/news/model-context-protocol)** - הצגת MCP המקורית  
- **[סקר מודלים לשוניים קטנים](https://arxiv.org/abs/2410.20011)** - סקר אקדמי על מחקר SLM  
- **[ניתוח שוק AI בקצה](https://www.marketsandmarkets.com/Market-Reports/edge-ai-software-market-74385617.html)** - מגמות ותחזיות בתעשייה  
- **[שיטות עבודה מומלצות לפיתוח סוכני AI](https://arxiv.org/abs/2309.02427)** - מחקר על ארכיטקטורות סוכנים  

חלק זה מספק את הבסיס לבניית יישומי MCP מבוססי SLM משלכם, ומאפשר אפשרויות לאוטומציה, עיבוד נתונים ושילוב מערכות חכמות.  

## ➡️ מה הלאה  

- [מודול 7. דוגמאות AI בקצה](../Module07/README.md)  

---

**כתב ויתור**:  
מסמך זה תורגם באמצעות שירות תרגום AI [Co-op Translator](https://github.com/Azure/co-op-translator). למרות שאנו שואפים לדיוק, יש לקחת בחשבון שתרגומים אוטומטיים עשויים להכיל שגיאות או אי דיוקים. המסמך המקורי בשפתו המקורית צריך להיחשב כמקור סמכותי. עבור מידע קריטי, מומלץ להשתמש בתרגום מקצועי אנושי. איננו אחראים לאי הבנות או לפרשנויות שגויות הנובעות משימוש בתרגום זה.