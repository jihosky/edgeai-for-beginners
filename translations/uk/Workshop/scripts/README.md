<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "4ace56b24e2799407b9972a7da6a7517",
  "translation_date": "2025-10-28T23:45:18+00:00",
  "source_file": "Workshop/scripts/README.md",
  "language_code": "uk"
}
-->
# Скрипти для воркшопу

Ця директорія містить автоматизовані та допоміжні скрипти, які використовуються для підтримки якості та узгодженості матеріалів воркшопу.

## Зміст

| Файл | Призначення |
|------|-------------|
| `lint_markdown_cli.py` | Перевіряє кодові блоки Markdown на застарілі шаблони команд Foundry Local CLI. |
| `export_benchmark_markdown.py` | Виконує тестування затримки для кількох моделей і створює звіти у форматі Markdown + JSON. |

## 1. Перевірка шаблонів Markdown CLI

`lint_markdown_cli.py` сканує всі файли `.md`, які не є перекладами, на наявність заборонених шаблонів команд Foundry Local CLI **всередині огороджених кодових блоків** (``` ... ```). Інформаційний текст все ще може згадувати застарілі команди для історичного контексту.

### Застарілі шаблони (заборонені всередині кодових блоків)

Перевірка блокує застарілі шаблони CLI. Використовуйте сучасні альтернативи.

### Необхідні заміни
| Застаріле | Використовуйте замість |
|-----------|-------------------------|
| `foundry model chat <a> "..."` | `foundry model run <a> --prompt "..."` |
| `foundry model list --running` | `foundry model list` |
| `foundry model list --cached` | `foundry cache list` |
| `foundry model stats` | Скрипт для тестування продуктивності + системні інструменти (`Task Manager`, `nvidia-smi`) |
| `foundry model benchmark` | `samples/session03/benchmark_oss_models.py` |
| `foundry model list --available` | `foundry model list` |

### Коди завершення
| Код | Значення |
|-----|----------|
| 0 | Порушень не виявлено |
| 1 | Виявлено один або більше застарілих шаблонів |

### Запуск локально
З кореня репозиторію (рекомендовано):

Windows (PowerShell):
```powershell
python Workshop\scripts\lint_markdown_cli.py --verbose
```

macOS / Linux:
```bash
python Workshop/scripts/lint_markdown_cli.py --verbose
```

### Хук перед комітом (опціонально)
```bash
echo "python Workshop/scripts/lint_markdown_cli.py" > .git/hooks/pre-commit
chmod +x .git/hooks/pre-commit
```
Це блокує коміти, які містять застарілі шаблони.

### Інтеграція з CI
Робочий процес GitHub Action (`.github/workflows/markdown-cli-lint.yml`) запускає перевірку при кожному push і pull request до гілок `main` та `Reactor`. Завдання, які не пройшли, потрібно виправити перед злиттям.

### Додавання нових застарілих шаблонів
1. Відкрийте `lint_markdown_cli.py`.
2. Додайте кортеж `(regex, suggestion)` до списку `DEPRECATED`. Використовуйте сирий рядок і включіть межі слів `\b`, де це доречно.
3. Запустіть перевірку локально, щоб переконатися у виявленні.
4. Зробіть коміт і push; CI забезпечить дотримання нового правила.

Приклад додавання:
```python
DEPRECATED.append((r"\\bfoundry\\s+experimental\\s+foo\\b", "Remove experimental foo usage"))
```

### Дозволені пояснювальні згадки
Оскільки перевірка застосовується лише до огороджених кодових блоків, ви можете безпечно описувати застарілі команди в тексті. Якщо *потрібно* показати їх у кодовому блоці для контрасту, додайте огороджений блок **без** потрійних зворотних лапок (наприклад, відступ або цитата) або перепишіть у псевдоформі.

### Пропуск окремих файлів (просунутий рівень)
За необхідності, розміщуйте приклади з застарілими командами в окремому файлі поза репозиторієм або змінюйте розширення під час розробки. Намірені пропуски для перекладених копій здійснюються автоматично (шляхи, що містять `translations`).

### Вирішення проблем
| Проблема | Причина | Рішення |
|----------|---------|---------|
| Перевірка позначає рядок, який ви оновили | Regex занадто широкий | Звузьте шаблон, додавши межі слова (`\b`) або якорі |
| CI не проходить, але локально все працює | Різна версія Python або незбережені зміни | Перезапустіть локально, переконайтеся, що робоче дерево чисте, перевірте версію Python у робочому процесі (3.11) |
| Потрібно тимчасово обійти | Екстрене виправлення | Застосуйте виправлення одразу після; розгляньте використання тимчасової гілки та наступного PR (уникайте додавання перемикачів обходу) |

### Обґрунтування
Підтримка документації у відповідності до *актуальної* стабільної поверхні CLI запобігає труднощам під час воркшопу, уникненню плутанини серед учасників і централізації вимірювання продуктивності через підтримувані Python-скрипти замість застарілих CLI-команд.

---
Підтримується як частина інструментарію для забезпечення якості воркшопу. Для покращень (наприклад, автоматичне виправлення пропозицій або генерація HTML-звітів) відкрийте issue або надішліть PR.

## 2. Скрипт для перевірки зразків

`validate_samples.py` перевіряє всі файли зразків Python на синтаксис, імпорти та відповідність найкращим практикам.

### Використання
```bash
# Validate all samples
python scripts/validate_samples.py

# Validate specific session
python scripts/validate_samples.py --session 01

# Verbose mode (includes best practice warnings)
python scripts/validate_samples.py --verbose

# Summary only
python scripts/validate_samples.py --summary
```

### Що перевіряється
- ✅ Валідність синтаксису Python
- ✅ Наявність необхідних імпортів
- ✅ Реалізація обробки помилок (розширений режим)
- ✅ Використання типів (розширений режим)
- ✅ Докстрінги функцій (розширений режим)
- ✅ Посилання на SDK (розширений режим)

### Змінні середовища
- `SKIP_IMPORT_CHECK=1` - Пропустити перевірку імпортів
- `SKIP_SYNTAX_CHECK=1` - Пропустити перевірку синтаксису

### Коди завершення
- `0` - Усі зразки пройшли перевірку
- `1` - Один або більше зразків не пройшли перевірку

## 3. Тестовий запуск зразків

`test_samples.py` виконує тестові запуски всіх зразків, щоб перевірити їх виконання без помилок.

### Використання
```bash
# Test all samples
python scripts/test_samples.py

# Test specific session
python scripts/test_samples.py --session 01

# Quick mode (shorter timeouts)
python scripts/test_samples.py --quick

# Verbose mode (show output)
python scripts/test_samples.py --verbose
```

### Передумови
- Запущена служба Foundry Local: `foundry service start`
- Завантажені моделі: `foundry model run phi-4-mini`
- Встановлені залежності: `pip install -r requirements.txt`

### Що тестується
- ✅ Зразок виконується без помилок під час виконання
- ✅ Генерується необхідний вихідний результат
- ✅ Коректна обробка помилок у разі невдачі
- ✅ Продуктивність (час виконання)

### Змінні середовища
- `FOUNDRY_LOCAL_ALIAS=phi-4-mini` - Модель для тестування
- `TEST_TIMEOUT=30` - Тайм-аут для кожного зразка в секундах

### Очікувані невдачі
Деякі тести можуть не пройти, якщо не встановлені опціональні залежності (наприклад, `ragas`, `sentence-transformers`). Встановіть за допомогою:
```bash
pip install sentence-transformers ragas datasets
```

### Коди завершення
- `0` - Усі тести пройшли
- `1` - Один або більше тестів не пройшли

## 4. Експортер результатів тестування продуктивності у Markdown

Скрипт: `export_benchmark_markdown.py`

Генерує відтворювану таблицю продуктивності для набору моделей.

### Використання
```powershell
python Workshop\scripts\export_benchmark_markdown.py --models "qwen2.5-0.5b" --prompt "Explain retrieval augmented generation briefly." --rounds 3 --output benchmark_report.md
```

### Вихідні файли
| Файл | Опис |
|------|------|
| `benchmark_report.md` | Таблиця у форматі Markdown (середнє значення, p95, токени/сек, опціонально перший токен) |
| `benchmark_report.json` | Масив сирих метрик для порівняння та історії |

### Опції
| Прапорець | Опис | За замовчуванням |
|-----------|------|------------------|
| `--models` | Список псевдонімів моделей через кому | (обов'язково) |
| `--prompt` | Підказка, що використовується кожного раунду | (обов'язково) |
| `--rounds` | Кількість раундів на модель | 3 |
| `--output` | Файл вихідного Markdown | `benchmark_report.md` |
| `--json` | Файл вихідного JSON | `benchmark_report.json` |
| `--fail-on-empty` | Нульовий вихід, якщо всі тести продуктивності не вдалися | вимкнено |

Змінна середовища `BENCH_STREAM=1` додає вимірювання затримки першого токена.

### Примітки
- Використовує `workshop_utils` для узгодженого запуску моделей та кешування.
- Якщо скрипт запускається з іншої робочої директорії, він намагається знайти `workshop_utils` через резервні шляхи.
- Для порівняння GPU: запустіть один раз, увімкніть прискорення через конфігурацію CLI, повторно запустіть і порівняйте JSON.

---

**Відмова від відповідальності**:  
Цей документ був перекладений за допомогою сервісу автоматичного перекладу [Co-op Translator](https://github.com/Azure/co-op-translator). Хоча ми прагнемо до точності, будь ласка, майте на увазі, що автоматичні переклади можуть містити помилки або неточності. Оригінальний документ на його рідній мові слід вважати авторитетним джерелом. Для критичної інформації рекомендується професійний людський переклад. Ми не несемо відповідальності за будь-які непорозуміння або неправильні тлумачення, що виникають внаслідок використання цього перекладу.