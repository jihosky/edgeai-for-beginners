<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "8a7765b85f123e8a62aa3847141ca072",
  "translation_date": "2025-10-30T14:15:56+00:00",
  "source_file": "Module06/03.IntroduceMCP.md",
  "language_code": "cs"
}
-->
# Sekce 03 - Integrace Model Context Protocol (MCP)

## Úvod do MCP (Model Context Protocol)

Model Context Protocol (MCP) je open-source standard pro propojení AI aplikací s externími systémy. Díky MCP mohou AI aplikace, jako Claude nebo ChatGPT, přistupovat k datovým zdrojům (např. lokální soubory, databáze), nástrojům (např. vyhledávače, kalkulačky) a pracovním postupům (např. specializované výzvy), což jim umožňuje získávat klíčové informace a provádět úkoly.

Představte si MCP jako **USB-C port pro AI aplikace**. Stejně jako USB-C poskytuje standardizovaný způsob propojení elektronických zařízení, MCP poskytuje standardizovaný způsob propojení AI aplikací s externími systémy.

### Co MCP umožňuje?

MCP odemyká silné schopnosti pro AI aplikace:

- **Personalizovaní AI asistenti**: Agenti mohou přistupovat k vašemu Google Kalendáři a Notion, čímž se stávají více personalizovanými AI asistenty.
- **Pokročilá generace kódu**: Claude Code může vytvořit celou webovou aplikaci na základě návrhu z Figma.
- **Integrace podnikových dat**: Podnikové chatboty mohou přistupovat k více databázím v rámci organizace, což uživatelům umožňuje analyzovat data prostřednictvím chatu.
- **Kreativní pracovní postupy**: AI modely mohou vytvářet 3D návrhy v Blenderu a tisknout je na 3D tiskárně.
- **Přístup k informacím v reálném čase**: Připojení k externím datovým zdrojům pro aktuální informace.
- **Komplexní vícekrokové operace**: Provádění sofistikovaných pracovních postupů kombinujících více nástrojů a systémů.

### Proč je MCP důležitý?

MCP přináší výhody napříč ekosystémem:

**Pro vývojáře**: MCP snižuje čas a složitost při vývoji nebo integraci AI aplikací či agentů.

**Pro AI aplikace**: MCP poskytuje přístup k ekosystému datových zdrojů, nástrojů a aplikací, což zlepšuje schopnosti a uživatelskou zkušenost.

**Pro koncové uživatele**: MCP vede k schopnějším AI aplikacím nebo agentům, kteří mohou přistupovat k vašim datům a provádět akce vaším jménem, když je to potřeba.

## Malé jazykové modely (SLMs) v MCP

Malé jazykové modely představují efektivní přístup k nasazení AI, nabízející několik výhod:

### Výhody SLMs
- **Efektivita zdrojů**: Nižší požadavky na výpočetní výkon.
- **Rychlejší odezvy**: Snížená latence pro aplikace v reálném čase.  
- **Nákladová efektivnost**: Minimální potřeby infrastruktury.
- **Soukromí**: Mohou běžet lokálně bez přenosu dat.
- **Přizpůsobení**: Snadnější doladění pro specifické oblasti.

### Proč SLMs dobře fungují s MCP

SLMs ve spojení s MCP vytvářejí silnou kombinaci, kde jsou schopnosti modelu v oblasti uvažování rozšířeny o externí nástroje, což kompenzuje jejich menší počet parametrů díky zvýšené funkčnosti.

## Přehled Python MCP SDK

Python MCP SDK poskytuje základ pro vytváření aplikací podporujících MCP. SDK zahrnuje:

- **Klientské knihovny**: Pro připojení k MCP serverům.
- **Serverový rámec**: Pro vytváření vlastních MCP serverů.
- **Správce protokolů**: Pro řízení komunikace.
- **Integrace nástrojů**: Pro provádění externích funkcí.

## Praktická implementace: Phi-4 MCP klient

Podívejme se na reálnou implementaci pomocí mini modelu Phi-4 od Microsoftu integrovaného s MCP schopnostmi.

### Přehled architektury MCP

MCP využívá **architekturu klient-server**, kde MCP hostitel (AI aplikace jako Claude Code nebo Claude Desktop) navazuje spojení s jedním nebo více MCP servery. MCP hostitel toho dosahuje vytvořením jednoho MCP klienta pro každý MCP server.

#### Klíčoví účastníci

- **MCP hostitel**: AI aplikace, která koordinuje a spravuje jednoho nebo více MCP klientů.
- **MCP klient**: Komponenta, která udržuje spojení s MCP serverem a získává kontext od MCP serveru pro použití MCP hostitelem.
- **MCP server**: Program, který poskytuje kontext MCP klientům.

#### Dvouvrstvá architektura

MCP se skládá ze dvou odlišných vrstev:

**Datová vrstva**: Definuje JSON-RPC protokol pro komunikaci klient-server, včetně:
- Správy životního cyklu (inicializace spojení, vyjednávání schopností).
- Základních prvků (nástroje, zdroje, výzvy).
- Klientských funkcí (sampling, elicitation, logování).
- Pomocných funkcí (notifikace, sledování pokroku).

**Transportní vrstva**: Definuje komunikační mechanismy a kanály:
- **STDIO Transport**: Používá standardní vstup/výstup pro lokální procesy (optimální výkon, žádná síťová zátěž).
- **Streamable HTTP Transport**: Používá HTTP POST s volitelnými Server-Sent Events pro vzdálené servery (podporuje standardní HTTP autentizaci).

```
┌─────────────────────────────────────┐
│           MCP Host                  │
│     (AI Application)                │
└─────────────────┬───────────────────┘
                  │
┌─────────────────┴───────────────────┐
│         MCP Client 1                │
│  ┌─────────────────────────────────┐ │
│  │        Data Layer               │ │
│  │  ├── Lifecycle Management       │ │
│  │  ├── Primitives (Tools/Resources)│ │
│  │  └── Notifications              │ │
│  └─────────────────────────────────┘ │
│  ┌─────────────────────────────────┐ │
│  │      Transport Layer           │ │
│  │  ├── STDIO Transport           │ │
│  │  └── HTTP Transport            │ │
│  └─────────────────────────────────┘ │
└─────────────────┬───────────────────┘
                  │
┌─────────────────┴───────────────────┐
│         MCP Server 1                │
│    (Local/Remote Context Provider)  │
└─────────────────────────────────────┘
```

### Základní prvky MCP

MCP definuje prvky, které specifikují typy kontextových informací, jež mohou být sdíleny s AI aplikacemi, a rozsah akcí, které mohou být prováděny.

#### Serverové prvky

MCP definuje tři základní prvky, které mohou servery zpřístupnit:

**Nástroje**: Spustitelné funkce, které mohou AI aplikace vyvolat k provedení akcí.
- Příklady: operace se soubory, API volání, dotazy do databáze.
- Metody: `tools/list`, `tools/call`.
- Podpora dynamického objevování a provádění.

**Zdroje**: Datové zdroje poskytující kontextové informace AI aplikacím.
- Příklady: obsah souborů, záznamy v databázi, odpovědi API.
- Metody: `resources/list`, `resources/read`.
- Umožňují přístup ke strukturovaným datům.

**Výzvy**: Znovupoužitelné šablony, které pomáhají strukturovat interakce s jazykovými modely.
- Příklady: systémové výzvy, příklady few-shot.
- Metody: `prompts/list`, `prompts/get`.
- Standardizují vzory interakcí AI.

#### Klientské prvky

MCP také definuje prvky, které mohou klienti zpřístupnit pro bohatší interakce:

**Sampling**: Umožňuje serverům požadovat dokončení jazykového modelu od AI aplikace klienta.
- Metoda: `sampling/complete`.
- Umožňuje vývoj serverů nezávislých na modelu.
- Poskytuje přístup k jazykovému modelu hostitele.

**Elicitation**: Umožňuje serverům požadovat dodatečné informace od uživatelů.
- Metoda: `elicitation/request`.
- Umožňuje interakci s uživatelem a potvrzení.
- Podporuje dynamické shromažďování informací.

**Logování**: Umožňuje serverům posílat logovací zprávy klientům.
- Používá se pro účely ladění a monitorování.
- Poskytuje přehled o operacích serveru.

### Životní cyklus MCP protokolu

#### Inicializace a vyjednávání schopností

MCP je stavový protokol, který vyžaduje správu životního cyklu. Proces inicializace slouží několika klíčovým účelům:

1. **Vyjednávání verze protokolu**: Zajišťuje, že klient i server používají kompatibilní verze protokolu (např. "2025-06-18").
2. **Objevování schopností**: Každá strana deklaruje podporované funkce a prvky.
3. **Výměna identit**: Poskytuje identifikační a verzovací informace.

```python
# Example initialization request
{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "initialize",
  "params": {
    "protocolVersion": "2025-06-18",
    "capabilities": {
      "elicitation": {},  # Client supports user interaction
      "sampling": {}      # Client can provide LLM completions
    },
    "clientInfo": {
      "name": "edge-ai-client",
      "version": "1.0.0"
    }
  }
}
```

#### Objevování nástrojů a jejich provádění

Po inicializaci mohou klienti objevovat a provádět nástroje:

```python
# Discover available tools
tools_response = await session.list_tools()

# Execute a tool
result = await session.call_tool(
    "weather_current",
    {
        "location": "San Francisco",
        "units": "imperial"
    }
)
```

#### Notifikace v reálném čase

MCP podporuje notifikace v reálném čase pro dynamické aktualizace:

```python
# Server sends notification when tools change
{
  "jsonrpc": "2.0",
  "method": "notifications/tools/list_changed"
}

# Client responds by refreshing tool list
await session.list_tools()  # Get updated tools
```

## Začínáme: Průvodce krok za krokem

### Krok 1: Nastavení prostředí

Nainstalujte požadované závislosti:
```bash
pip install fastmcp mcp-python-client openai requests pyautogui Pillow
```

### Krok 2: Základní konfigurace

Nastavte své proměnné prostředí:
```python
# System Configuration
SYSTEM_PROMPT = "You are an AI assistant with some tools."

# Ollama Configuration (Local)
OLLAMA_URL = "http://localhost:11434/api/chat"
OLLAMA_MODEL_ID = "phi4-mini:3.8b-fp16"

# vLLM Configuration (Server)
VLLM_URL = "http://localhost:8000/v1"
VLLM_MODEL_ID = "microsoft/Phi-4-mini-instruct"
```

### Krok 3: Spuštění prvního MCP klienta

**Základní nastavení Ollama:**
```bash
python ghmodel_mcp_demo.py
```

**Použití vLLM backendu:**
```bash
python ghmodel_mcp_demo.py --env vllm
```

**Připojení pomocí Server-Sent Events:**
```bash
python ghmodel_mcp_demo.py --run sse
```

**Vlastní MCP server:**
```bash
python ghmodel_mcp_demo.py --server /path/to/server.py
```

### Krok 4: Programové použití

```python
import asyncio
from ghmodel_mcp_demo import OllamaClient, Phi4MiniMCPClient

async def automated_interaction():
    # Configure MCP server parameters
    server_params = StdioServerParameters(
        command="npx",
        args=["@playwright/mcp@latest"],
        env=None,
    )
    
    # Create MCP client and process tools
    async with Phi4MiniMCPClient(server_params) as mcp_client:
        tools = await process_mcp_tools(mcp_client)
        llm_client = OllamaClient()
        
        # Generate response with tool capabilities
        response, messages = await llm_client.generate_response(
            "Help me automate a web task",
            tools
        )
        return response

# Execute the automation
result = asyncio.run(automated_interaction())
print(result)
```

## Pokročilé funkce

### Podpora více backendů

Implementace podporuje jak Ollama, tak vLLM backendy, což vám umožňuje volbu podle vašich požadavků:

- **Ollama**: Lepší pro lokální vývoj a testování.
- **vLLM**: Optimalizováno pro produkci a scénáře s vysokou propustností.

### Flexibilní protokoly připojení

Podporovány jsou dva režimy připojení:

**STDIO režim**: Přímá komunikace procesů.
- Nižší latence.
- Vhodné pro lokální nástroje.
- Jednoduché nastavení.

**SSE režim**: Streamování založené na HTTP.
- Schopné práce v síti.
- Lepší pro distribuované systémy.
- Aktualizace v reálném čase.

### Schopnosti integrace nástrojů

Systém může integrovat různé nástroje:
- Webová automatizace (Playwright).
- Operace se soubory.
- Interakce s API.
- Systémové příkazy.
- Vlastní funkce.

## Řešení chyb a osvědčené postupy

### Komplexní správa chyb

Implementace zahrnuje robustní řešení chyb pro:

**Chyby připojení:**
- Selhání MCP serveru.
- Časové limity sítě.
- Problémy s konektivitou.

**Chyby při provádění nástrojů:**
- Chybějící nástroje.
- Validace parametrů.
- Selhání provádění.

**Chyby při zpracování odpovědí:**
- Problémy s parsováním JSON.
- Nekonzistence formátu.
- Anomálie v odpovědích LLM.

### Osvědčené postupy

1. **Správa zdrojů**: Používejte asynchronní správce kontextu.
2. **Řešení chyb**: Implementujte komplexní bloky try-catch.
3. **Logování**: Aktivujte vhodné úrovně logování.
4. **Bezpečnost**: Validujte vstupy a čistěte výstupy.
5. **Výkon**: Používejte pooling připojení a caching.

## Reálné aplikace

### Webová automatizace
```python
# Example: Automated web testing
async def web_automation_example():
    tools = await setup_playwright_tools()
    response = await llm_client.generate_response(
        "Navigate to example.com and take a screenshot",
        tools
    )
```

### Zpracování dat
```python
# Example: File analysis
async def data_processing_example():
    tools = await setup_file_tools()
    response = await llm_client.generate_response(
        "Analyze the CSV file and generate a summary report",
        tools
    )
```

### Integrace API
```python
# Example: API interactions
async def api_integration_example():
    tools = await setup_api_tools()
    response = await llm_client.generate_response(
        "Fetch weather data and create a forecast summary",
        tools
    )
```

## Optimalizace výkonu

### Správa paměti
- Efektivní správa historie zpráv.
- Správné čištění zdrojů.
- Pooling připojení.

### Optimalizace sítě
- Asynchronní HTTP operace.
- Konfigurovatelné časové limity.
- Plynulé zotavení z chyb.

### Současné zpracování
- Neblokující I/O.
- Paralelní provádění nástrojů.
- Efektivní asynchronní vzory.

## Bezpečnostní aspekty

### Ochrana dat
- Bezpečná správa API klíčů.
- Validace vstupů.
- Čištění výstupů.

### Síťová bezpečnost
- Podpora HTTPS.
- Výchozí lokální endpointy.
- Bezpečná správa tokenů.

### Bezpečnost provádění
- Filtrování nástrojů.
- Sandboxované prostředí.
- Auditní logování.

## Ekosystém MCP a vývoj

### Rozsah projektu MCP

Ekosystém Model Context Protocol zahrnuje několik klíčových komponent:

- **[Specifikace MCP](https://modelcontextprotocol.io/specification/latest)**: Oficiální specifikace popisující požadavky na implementaci klientů a serverů.
- **[MCP SDKs](https://modelcontextprotocol.io/docs/sdk)**: SDK pro různé programovací jazyky implementující MCP.
- **Vývojové nástroje MCP**: Nástroje pro vývoj MCP serverů a klientů, včetně [MCP Inspector](https://github.com/modelcontextprotocol/inspector).
- **[Referenční implementace MCP serverů](https://github.com/modelcontextprotocol/servers)**: Referenční implementace MCP serverů.

### Začínáme s vývojem MCP

Pro začátek práce s MCP:

**Vytváření serverů**: [Vytvořte MCP servery](https://modelcontextprotocol.io/docs/develop/build-server), které zpřístupní vaše data a nástroje.

**Vytváření klientů**: [Vyvíjejte aplikace](https://modelcontextprotocol.io/docs/develop/build-client), které se připojují k MCP serverům.

**Učení konceptů**: [Pochopte základní koncepty](https://modelcontextprotocol.io/docs/learn/architecture) a architekturu MCP.

## Závěr

SLMs integrované s MCP představují posun v vývoji AI aplikací. Kombinací efektivity malých modelů s výkonem externích nástrojů mohou vývojáři vytvářet inteligentní systémy, které jsou jak efektivní z hlediska zdrojů, tak vysoce schopné.

Model Context Protocol poskytuje standardizovaný způsob propojení AI aplikací s externími systémy, podobně jako USB-C poskytuje univerzální standard propojení elektronických zařízení. Tato standardizace umožňuje:

- **Bezproblémovou integraci**: Propojení AI modelů s různými datovými zdroji a nástroji.
- **Růst ekosystému**: Jednou vytvořte, používejte napříč více AI aplikacemi.
- **Rozšířené schopnosti**: Rozšíření SLMs o externí funkce.
- **Aktualizace v reálném čase**: Podpora dynamických, responzivních AI aplikací.

Klíčové poznatky:
- MCP je otevřený standard, který propojuje AI aplikace a externí systémy.
- Protokol podporuje nástroje, zdroje a výzvy jako základní prvky.
- Notifikace v reálném čase umožňují dynamické, responzivní aplikace.
- Správná správa životního cyklu a řešení chyb jsou nezbytné pro produkční použití.
- Ekosystém poskytuje komplexní SDK a vývojové nástroje.

## Odkazy a další čtení

### Oficiální dokumentace MCP

- **[Oficiální stránka Model Context Protocol](https://modelcontextprotocol.io/)** - Kompletní dokumentace a specifikace.
- **[Průvodce začátkem s MCP](https://modelcontextprotocol.io/docs/getting-started/intro)** - Úvod a základní koncepty.
- **[Přehled architektury MCP](https://modelcontextprotocol.io/docs/learn/architecture)** - Detailní technická architektura.
- **[Specifikace MCP](https://modelcontextprotocol.io/specification/latest)** - Oficiální specifikace protokolu.
- **[Dokumentace MCP SDKs](https://modelcontextprotocol.io/docs/sdk)** - Průvodce SDK pro konkrétní jazyky.

### Vývojové zdroje

- **[MCP pro začátečníky](https://aka.ms/mcp-for-beginners)** - Komplexní průvodce Model Context Protocol pro začátečníky.
- **[GitHub organizace MCP](https://github.com/modelcontextprotocol)** - Oficiální repozitáře a příklady.
- **[Repozitář MCP serverů](https://github.com/modelcontextprotocol/servers)** - Referenční implementace serverů.
- **[MCP Inspector](https://github.com/modelcontextprotocol/inspector)** - Nástroj pro vývoj a ladění.

- **[Ollama Dokumentace](https://ollama.ai/docs)** - Platforma pro lokální nasazení LLM
- **[vLLM Dokumentace](https://docs.vllm.ai/)** - Vysoce výkonné poskytování LLM

### Technické standardy a protokoly

- **[JSON-RPC 2.0 Specifikace](https://www.jsonrpc.org/)** - Základní RPC protokol používaný MCP
- **[JSON Schema](https://json-schema.org/)** - Standard pro definici schémat nástrojů MCP
- **[OpenAPI Specifikace](https://swagger.io/specification/)** - Standard pro dokumentaci API
- **[Server-Sent Events (SSE)](https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events)** - Webový standard pro aktualizace v reálném čase

### Vývoj AI agentů

- **[Microsoft Agent Framework](https://github.com/microsoft/agent-framework)** - Vývoj agentů připravených pro produkci
- **[LangChain Dokumentace](https://docs.langchain.com/)** - Rámec pro integraci agentů a nástrojů
- **[Semantic Kernel](https://learn.microsoft.com/en-us/semantic-kernel/)** - Orchestrační SDK od Microsoftu pro AI

### Průmyslové zprávy a výzkum

- **[Oznámení o Model Context Protocol od Anthropicu](https://www.anthropic.com/news/model-context-protocol)** - Původní představení MCP
- **[Průzkum malých jazykových modelů](https://arxiv.org/abs/2410.20011)** - Akademický průzkum výzkumu SLM
- **[Analýza trhu Edge AI](https://www.marketsandmarkets.com/Market-Reports/edge-ai-software-market-74385617.html)** - Trendy a prognózy v průmyslu
- **[Nejlepší postupy pro vývoj AI agentů](https://arxiv.org/abs/2309.02427)** - Výzkum architektur agentů

Tato sekce poskytuje základy pro vytváření vlastních aplikací MCP poháněných SLM, čímž otevírá možnosti pro automatizaci, zpracování dat a integraci inteligentních systémů.

## ➡️ Co dál

- [Modul 7. Ukázky Edge AI](../Module07/README.md)

---

**Prohlášení**:  
Tento dokument byl přeložen pomocí služby AI pro překlady [Co-op Translator](https://github.com/Azure/co-op-translator). I když se snažíme o přesnost, mějte prosím na paměti, že automatizované překlady mohou obsahovat chyby nebo nepřesnosti. Původní dokument v jeho původním jazyce by měl být považován za autoritativní zdroj. Pro důležité informace se doporučuje profesionální lidský překlad. Neodpovídáme za žádná nedorozumění nebo nesprávné interpretace vyplývající z použití tohoto překladu.